<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Epic Games</title>

<link rel="website icon" type="png" href="img/logosteam.png"> <%-- para que en la pestalla salga el logo o una imagen --%> 

<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css"
	rel="stylesheet">
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css"
	rel="stylesheet">
	
	<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<link th:href="@{/css/estilos.css}" rel="stylesheet">

<%-- scrips para DATATABLES --%>
<!-- DataTables CSS -->
<link rel="stylesheet" href="https://cdn.datatables.net/2.3.2/css/dataTables.dataTables.min.css">
<!-- jQuery  -->
<script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
<!-- DataTables Librería -->
<script src="https://cdn.datatables.net/2.3.2/js/dataTables.min.js"></script>
<!-- recursos adicionales -->		
<link rel="stylesheet" href="https://cdn.datatables.net/buttons/2.4.1/css/buttons.dataTables.min.css">

<script src="https://cdn.datatables.net/buttons/2.4.1/js/dataTables.buttons.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.html5.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.print.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/pdfmake.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/vfs_fonts.js"></script>

</head>
<body>

<div id="contenedor">
  <jsp:include page="./componentes/cabecera.jsp"/>



	<div class="layout ">
	
	   <div th:insert="@{/componentes/menu}"></div>

		<div class="main-wrapper">

			<div class="container-fluid pt-5 px-4">


				<h1 class="text-light text-center">Administrar catálogo de
					juegos</h1>



				<button class="btn btn-primary mb-5" data-bs-toggle="modal"
					data-bs-target="#modalRegistrar">Agregar juego</button>
				





				<div
					class="table-responsive rounded border border-secondary overflow-hidden">

					<table id="tablaJuegos" class="table table-dark table-hover align-middle mb-0">
						<thead>
							<tr>
								<th scope="col" class="ps-3">ID</th>
								<th scope="col">Portada</th>
								<th scope="col">Título</th>
								<th scope="col">Descripción</th>
								<th scope="col">Precio</th>
								<th scope="col">Fecha de registro</th>
								<th scope="col">Categoría</th>
								<th scope="col">Estado</th>

								<th class="text-center" scope="col">Acciones</th>

							</tr>
						</thead>

						<tbody>
							<c:forEach var="cej" items="${lstJuegos}">
								<tr>
									<td class="ps-3">${cej.idJuego}</td>
									<td>
									<img alt="imagen" src="img/juegos/${cej.idJuego}.png"
                                        style="width: 50px; height: 60px;"
                                        onerror="src='img/juegos/no-imagen.png'">
									
									</td>
									<td>${cej.titulo}</td>
									<td>${cej.descripcion}</td>
									<fmt:setLocale value="es-PE" /> <%--para definir la modeda en este caso S/ --%>
									<td>  
	                                <fmt:formatNumber value="${cej.precio}"
							            type="currency"
							            minFractionDigits="2"
							            maxFractionDigits="2" /><%-- para que siempre sean 2 decimales --%>
						            </td>
									
									<td class="text-center">${cej.fechReg}</td>
								
									
									<td>${cej.categoria}</td>
									
									<td> ${cej.estado }</td>
									

									<td style="height: 60px;">
										<div
											class="d-flex justify-content-evenly align-items-center h-100 gap-2 pb-1">
											<a class="btn btn-primary btn-sm"
												href="actualizaj?q=${cej.idJuego}">Editar</a>
												
												
												<c:if test="${cej.estado ne 'eliminado'}">

											<form class="m-0" action="eliminaj?id=${cej.idJuego}"
												method="post">
												
												<button type="submit" class="btn btn-danger btn-sm"
													onclick="return confirm('¿Eliminar juego?')">
													Eliminar</button>
													
											</form>
											
												</c:if>
											
										</div>
									</td>

								</tr>
							</c:forEach>
						</tbody>
					</table>
				</div>



			</div>
		</div>
	</div>

	<div class="modal" id="modalRegistrar">
		<div class="modal-dialog">
			<div class="modal-content">
				<div
					class="container rounded text-bg-dark border border-secondary px-5 py-3">
					
					<h2 class="text-center">Agregar juego</h2>


					<form action="registraj" method="post" class="row g-4">

						<div class="col-md-12">
							<label class="form-label">Título</label> <input type="text"
								name="titulo" class="form-control" maxlength="150" required>
						</div>

						<div class="col-md-12">
							<label class="form-label">Descripción</label>
							<textarea name="descripcion" class="form-control" maxlength="500"
								rows="4" style="resize: none; overflow-y: auto;" required></textarea>
						</div>

						<div class="col-md-6">
							<label class="form-label">Precio</label> <input type="number"
								name="precio" step="0.01" min="0" max="99999999.99"
								class="form-control" required>
						</div>

						<div class="col-md-6">
							<label class="form-label">Categoría</label> <select
								name="categoria" class="form-select" required>

								<option value="">Seleccione...</option>

								<c:forEach var="c" items="${lstCategorias}">
									<option value="${c.id_categoria}">${c.nom_categoria}</option>
								</c:forEach>

							</select>
						</div>
						
						

						<div class="col-md-12 d-flex justify-content-start gap-3">
						
						

						<button type="submit" class="btn btn-primary">Guardar</button>

						<a href="listaj" class="btn btn-danger"> Cancelar </a>
						
						</div>
						

					</form>
				</div>
			</div>
		</div>
	</div>
		</div>
		
		</div>
    <footer class="footer">
      <i class="bi bi-tiktok fs-2 m-2"></i>
      <i class="bi bi-facebook fs-2 m-2"></i>
      <i class="bi bi-youtube fs-2 m-2"></i>
      <p>Derechos Reservados. Lima, Perú - 2025</p>
    </footer>

  </div>
		
		
	${mensaje }


	<script
		src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"></script>
		
		<script>
	  $('#tablaJuegos').DataTable({
	    language: {
		url: 'https://cdn.datatables.net/plug-ins/1.13.6/i18n/es-ES.json'
	    },
	    dom: 'Bfrtip',
		buttons: ['copy', 'excel', 'csv', 'pdf', 'print', 'colvis', 'pageLength']
	   });
	</script>
</body>
</html>